<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login/Signup Form</title>
    
    <style>
        /* Stylesheet for LoginSignup Component */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(180deg, #fe5304 0%, #fe5304 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 90%; 
            max-width: 450px; 
            background: #ffffff;
            border-radius: 12px;
            padding: 30px 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease-in-out;
        }

        .text {
            color: #fe5304;
            font-size: 32px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .inputs {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }

        .input {
            display: flex;
            align-items: center;
            background: #f7f7f7;
            border-radius: 8px;
            padding: 10px 15px;
            border: 1px solid #e0e0e0;
        }

        .input:focus-within {
            border-color: #fe5304;
            box-shadow: 0 0 0 3px rgba(4, 191, 254, 0.1);
        }

        .input input {
            height: 40px;
            width: 100%;
            background: transparent;
            border: none;
            outline: none;
            color: #333333;
            font-size: 16px;
        }

        .forgot-password {
            padding-left: 20px;
            margin-top: 15px;
            color: #777777;
            font-size: 14px;
            cursor: pointer;
            text-align: right;
        }

        .forgot-password span {
            color: #fe5304;
            font-weight: 600;
        }

        .submit-container {
            display: flex;
            gap: 20px;
            margin: 30px auto 10px auto;
        }

        .submit {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 50px;
            color: #ffffff;
            background: #fe5304;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            text-transform: uppercase;
        }

        .submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(204, 65, 1, 0.3);
        }

        .gray {
            background: #e9ecef;
            color: #333333;
        }

        /* New Style for Status Message */
        .status-message {
            text-align: center;
            margin-top: 15px;
            font-weight: 600;
            padding: 10px;
            border-radius: 6px;
        }

        .status-message.error {
            color: #ff0000;
            background-color: #ffeaea;
            border: 1px solid #ff0000;
        }

        .status-message.success {
            color: #008000;
            background-color: #eaffea;
            border: 1px solid #008000;
        }

    </style>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const BASE_URL = 'https://ems-api.mataaa.com/gateway/UserManagement/api/v1'; // Assuming a UserManagement service for Auth

        const LoginSignup = () => {
            const [isLogin, setIsLogin] = React.useState(true);
            const [name, setName] = React.useState(''); // Added for Sign Up
            const [email, setEmail] = React.useState('');
            const [password, setPassword] = React.useState('');
            const [message, setMessage] = React.useState({ text: '', type: '' }); // State for status messages
            const [isLoading, setIsLoading] = React.useState(false); // State for loading

            // Clear message whenever the form state changes
            React.useEffect(() => {
                setMessage({ text: '', type: '' });
            }, [isLogin, email, password, name]);


            const handleLogin = async () => {
                // Client-side validation
                if (!email || !password) {
                    setMessage({ text: 'Please enter both email and password.', type: 'error' });
                    return;
                }

                setIsLoading(true);

                try {
                    const response = await fetch(`${BASE_URL}/auth/login`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'accept': '*/*'
                        },
                        body: JSON.stringify({
                            email: email,
                            password: password
                            // Add any other required fields for your Login API
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        // Assuming the API returns a token or user data on success
                        console.log("Login Successful!", data);
                        // Store token in local storage and redirect
                        // localStorage.setItem('userToken', data.token); 
                        setMessage({ text: 'Login successful! Redirecting...', type: 'success' });
                        // window.location.href = 'dashboard.html'; // Uncomment to redirect
                    } else {
                        // Handle non-200 responses (e.g., 401 Unauthorized)
                        const errorData = await response.json();
                        setMessage({ text: errorData.message || 'Login Failed. Check your credentials.', type: 'error' });
                    }
                } catch (error) {
                    console.error('API Error:', error);
                    setMessage({ text: 'Network error. Could not reach the API.', type: 'error' });
                } finally {
                    setIsLoading(false);
                }
            };

            const handleSignup = async () => {
                // Client-side validation
                if (!name || !email || !password) {
                    setMessage({ text: 'Please fill out all fields.', type: 'error' });
                    return;
                }
                
                setIsLoading(true);

                try {
                    const response = await fetch(`${BASE_URL}/auth/signup`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'accept': '*/*'
                        },
                        body: JSON.stringify({
                            userName: name, // Adjust key based on your API spec
                            email: email,
                            password: password
                            // Add any other required fields for your Sign Up API
                        })
                    });

                    if (response.ok) {
                        // Assuming the API returns success status
                        const data = await response.json();
                        console.log("Sign Up Successful!", data);
                        setMessage({ 
                            text: 'Sign Up successful! You can now log in.', 
                            type: 'success' 
                        });
                        // Optionally switch to login view
                        // setIsLogin(true);
                    } else {
                        // Handle API-specific errors (e.g., 409 Conflict - user already exists)
                        const errorData = await response.json();
                        setMessage({ text: errorData.message || 'Sign Up Failed. Try again later.', type: 'error' });
                    }
                } catch (error) {
                    console.error('API Error:', error);
                    setMessage({ text: 'Network error. Could not reach the API.', type: 'error' });
                } finally {
                    setIsLoading(false);
                }
            };

            const handleSubmit = isLogin ? handleLogin : handleSignup;


            return (
                <div className='container'>
                    <div className='text'>{isLogin ? 'Login' : 'Sign Up' }</div>

                    <div className='inputs'>
                        {!isLogin && (
                            <div className="input">
                                <input 
                                    type="text" 
                                    placeholder="Name or Username"
                                    value={name}
                                    onChange={(e) => setName(e.target.value)}
                                />
                            </div>
                        )}
                        <div className="input">
                            <input 
                                type="email" 
                                placeholder="Email"
                                value={email}
                                onChange={(e) => setEmail(e.target.value)}
                            />
                        </div>
                        <div className="input">
                            <input 
                                type="password" 
                                placeholder="Password"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                            />
                        </div>
                    </div>

                    {isLogin ? null : (
                        <div className="forgot-password">Lost password? <span>CLICK HERE!</span></div>
                    )}
                    
                    {/* Status Message Display */}
                    {message.text && (
                        <div className={`status-message ${message.type}`}>
                            {message.text}
                        </div>
                    )}

                    <div className="submit-container">
                        <div 
                            className="submit" 
                            onClick={isLoading ? null : handleSubmit} // Disable button while loading
                            style={{ opacity: isLoading ? 0.6 : 1 }}
                        >
                            {isLoading ? 'Processing...' : (isLogin ? 'Login' : 'Sign Up')}
                        </div>
                    </div>

                    <div className="forgot-password" onClick={() => {
                        setIsLogin(!isLogin);
                        setName(''); // Clear inputs on switch
                        setEmail('');
                        setPassword('');
                    }}>
                        {isLogin ? 'Need an account? Switch to Sign Up' : 'Already have an account? Switch to Login'}
                    </div>
                </div>
            );
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<LoginSignup />);
    </script>
</body>
</html>